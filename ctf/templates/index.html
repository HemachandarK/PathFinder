<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evacuation Path Finder</title>
    <style>
        #blueprintCanvas {
            border: 1px solid black;
        }
    </style>
</head>
<body>
    <h1>Evacuation Path Finder</h1>
    
    <label for="scenario">Select Disaster Scenario:</label>
    <select id="scenario">
        <option value="fire">Fire</option>
        <option value="earthquake">Earthquake</option>
        <option value="flood">Flood</option>
    </select>

    <canvas id="blueprintCanvas" width="250" height="250"></canvas>
    <br>
    <button onclick="findPath()">Find Path</button>

    <script>
        async function fetchPathFromAIModel(start, end, scenario) {
            const response = await fetch('/get_path', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ start, goal: end, scenario }),
            });

            const data = await response.json();
            return data.path;  // AI model's path coordinates
        }

        async function findPath() {
            const start = [0, 0]; // Starting coordinates (x, y)
            const end = [4, 4];   // Goal coordinates (x, y)
            const scenario = document.getElementById('scenario').value; // Get selected scenario

            const path = await fetchPathFromAIModel(start, end, scenario);
            drawPath(path);
        }

        function drawPath(path) {
            const canvas = document.getElementById('blueprintCanvas');
            const ctx = canvas.getContext('2d');
            
            // Clear the canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw the grid
            const cellSize = 50;  // Size of each cell
            for (let x = 0; x < 5; x++) {
                for (let y = 0; y < 5; y++) {
                    ctx.strokeRect(x * cellSize, y * cellSize, cellSize, cellSize);
                }
            }
            
            // Draw the path
            ctx.fillStyle = 'blue';
            path.forEach(coord => {
                ctx.fillRect(coord[1] * cellSize, coord[0] * cellSize, cellSize, cellSize); // Note the order for x and y
            });
        }
    </script>
</body>
</html>
